<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 DiD in multi-period set up | Difference in Differences</title>
  <meta name="description" content="4 DiD in multi-period set up | Difference in Differences" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="4 DiD in multi-period set up | Difference in Differences" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 DiD in multi-period set up | Difference in Differences" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="canonical-difference-in-differences-framework.html"/>
<link rel="next" href="conditional-parallel-trend.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="a-quick-introduction.html"><a href="a-quick-introduction.html"><i class="fa fa-check"></i><b>1</b> A Quick Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="set-up.html"><a href="set-up.html"><i class="fa fa-check"></i><b>1.1</b> Set up</a></li>
<li class="chapter" data-level="1.2" data-path="an-example-evaluating-the-impact-of-medicaid-expansion-on-uninsured-rate.html"><a href="an-example-evaluating-the-impact-of-medicaid-expansion-on-uninsured-rate.html"><i class="fa fa-check"></i><b>1.2</b> An example: Evaluating the impact of Medicaid expansion on uninsured rate</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="naive-estimator.html"><a href="naive-estimator.html"><i class="fa fa-check"></i><b>2</b> Naive estimator</a></li>
<li class="chapter" data-level="3" data-path="canonical-difference-in-differences-framework.html"><a href="canonical-difference-in-differences-framework.html"><i class="fa fa-check"></i><b>3</b> Canonical Difference in Differences Framework</a></li>
<li class="chapter" data-level="4" data-path="did-in-multi-period-set-up.html"><a href="did-in-multi-period-set-up.html"><i class="fa fa-check"></i><b>4</b> DiD in multi-period set up</a></li>
<li class="chapter" data-level="5" data-path="conditional-parallel-trend.html"><a href="conditional-parallel-trend.html"><i class="fa fa-check"></i><b>5</b> Conditional Parallel Trend</a>
<ul>
<li class="chapter" data-level="5.1" data-path="some-concerns-with-controls.html"><a href="some-concerns-with-controls.html"><i class="fa fa-check"></i><b>5.1</b> Some concerns with controls</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-2-times-2-difference-in-differences-estimate.html"><a href="the-2-times-2-difference-in-differences-estimate.html"><i class="fa fa-check"></i><b>6</b> The <span class="math inline">\(2 \times 2\)</span> Difference-in-Differences Estimate</a></li>
<li class="chapter" data-level="7" data-path="event-study-model.html"><a href="event-study-model.html"><i class="fa fa-check"></i><b>7</b> Event study model</a></li>
<li class="chapter" data-level="8" data-path="two-way-fixed-effect.html"><a href="two-way-fixed-effect.html"><i class="fa fa-check"></i><b>8</b> Two way fixed effect</a></li>
<li class="chapter" data-level="9" data-path="various-ways-of-estimation.html"><a href="various-ways-of-estimation.html"><i class="fa fa-check"></i><b>9</b> Various ways of estimation</a></li>
<li class="chapter" data-level="10" data-path="multi-period-multi-group-and-variation-in-treatment-timing.html"><a href="multi-period-multi-group-and-variation-in-treatment-timing.html"><i class="fa fa-check"></i><b>10</b> Multi Period, Multi Group and Variation in Treatment Timing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="problem-with-twfe-in-multiple-group-with-treatment-timing-variation.html"><a href="problem-with-twfe-in-multiple-group-with-treatment-timing-variation.html"><i class="fa fa-check"></i><b>10.1</b> Problem with TWFE in Multiple Group with Treatment Timing Variation</a></li>
<li class="chapter" data-level="10.2" data-path="what-is-twfe-estimating-when-there-is-treatment-timing-variation.html"><a href="what-is-twfe-estimating-when-there-is-treatment-timing-variation.html"><i class="fa fa-check"></i><b>10.2</b> What is TWFE Estimating when there is Treatment Timing Variation?</a></li>
<li class="chapter" data-level="10.3" data-path="assumptions-governing-twfedd-estimate.html"><a href="assumptions-governing-twfedd-estimate.html"><i class="fa fa-check"></i><b>10.3</b> Assumptions governing TWFEDD estimate</a></li>
<li class="chapter" data-level="10.4" data-path="how-does-treatment-effect-heterogeneity-in-time-affect-twfe.html"><a href="how-does-treatment-effect-heterogeneity-in-time-affect-twfe.html"><i class="fa fa-check"></i><b>10.4</b> How Does Treatment Effect Heterogeneity in Time Affect TWFE?</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Difference in Differences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="did-in-multi-period-set-up" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> DiD in multi-period set up<a href="did-in-multi-period-set-up.html#did-in-multi-period-set-up" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>So far we have only considered the canonical DiD (two groups and two period DiD framework).</p>
<p>However, data may be available for several periods before and after the treatment implementation. In this case, we will be in the setting of multi-period DiD. For example, for the Medicaid expansion case, we have data spanning from years 2010 to 2017. We’d like to utilize all of these years rather than just years 2013 and 2014 as in the canonical DiD setting.</p>
<p>Using the multi-period set up can be helpful for the following reasons:</p>
<ol style="list-style-type: lower-roman">
<li><p>We can trace the dynamic effects of the treatment following the implementation. This means that we can trace the ATT estimate of Medicaid expansion for periods following its implementation, i.e., in 2014, 2015, 2016, and 2017. If the effects of expansion are increasing over time, then this setting will be very helpful in uncovering such dynamics. In other words, we can trace the potential heterogeneous effects of the treatment over time.</p></li>
<li><p>Next, the multi-period setting allows us to way to check the validity of the parallel trend assumption. As mentioned above, the exact test for the parallel trend assumption is infeasible. However, we can deduce suggestive evidence to assess validity of this assumption. See below.</p></li>
</ol>
<p>Let’s first plot the mean uninsured rate between the years 2010 and 2017 across the treatment versus the control groups.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="did-in-multi-period-set-up.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the mean uninsured rate by expansion status and year</span></span>
<span id="cb24-2"><a href="did-in-multi-period-set-up.html#cb24-2" aria-hidden="true" tabindex="-1"></a>dat_sum  <span class="ot">&lt;-</span> mort_allcauses  <span class="sc">%&gt;%</span>  </span>
<span id="cb24-3"><a href="did-in-multi-period-set-up.html#cb24-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">group_by</span>(year, expand)  <span class="sc">%&gt;%</span>  </span>
<span id="cb24-4"><a href="did-in-multi-period-set-up.html#cb24-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summarize</span>(<span class="at">uninsured =</span> <span class="fu">mean</span>(sahieunins138))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="did-in-multi-period-set-up.html#cb26-1" aria-hidden="true" tabindex="-1"></a>post_cf_treat  <span class="ot">&lt;-</span> dat_sum<span class="sc">$</span>uninsured[dat_sum<span class="sc">$</span>expand <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span> naive_pre</span>
<span id="cb26-2"><a href="did-in-multi-period-set-up.html#cb26-2" aria-hidden="true" tabindex="-1"></a>dat_treat_cf  <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">seq</span>(<span class="dv">2010</span>, <span class="dv">2017</span>, <span class="dv">1</span>), <span class="at">expand =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">cf =</span> post_cf_treat)</span>
<span id="cb26-3"><a href="did-in-multi-period-set-up.html#cb26-3" aria-hidden="true" tabindex="-1"></a>dat_sum  <span class="ot">&lt;-</span> dat_sum  <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="did-in-multi-period-set-up.html#cb26-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">left_join</span>(dat_treat_cf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;expand&quot;</span>))</span>
<span id="cb26-5"><a href="did-in-multi-period-set-up.html#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="did-in-multi-period-set-up.html#cb26-6" aria-hidden="true" tabindex="-1"></a>f_uninsured  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_sum, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> uninsured, <span class="at">group =</span> <span class="fu">as.factor</span>(expand), <span class="at">color =</span> <span class="fu">as.factor</span>(expand)), <span class="at">shape =</span> <span class="fu">as.factor</span>(expand)) <span class="sc">+</span> </span>
<span id="cb26-7"><a href="did-in-multi-period-set-up.html#cb26-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb26-8"><a href="did-in-multi-period-set-up.html#cb26-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2014</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb26-9"><a href="did-in-multi-period-set-up.html#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="did-in-multi-period-set-up.html#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_sum, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> uninsured, <span class="at">group =</span> <span class="fu">as.factor</span>(expand), <span class="at">color =</span> <span class="fu">as.factor</span>(expand)), <span class="at">shape =</span> <span class="fu">as.factor</span>(expand)) <span class="sc">+</span> </span>
<span id="cb26-11"><a href="did-in-multi-period-set-up.html#cb26-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb26-12"><a href="did-in-multi-period-set-up.html#cb26-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2014</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-13"><a href="did-in-multi-period-set-up.html#cb26-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">data =</span> dat_sum, </span>
<span id="cb26-14"><a href="did-in-multi-period-set-up.html#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">y =</span> cf), </span>
<span id="cb26-15"><a href="did-in-multi-period-set-up.html#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb26-16"><a href="did-in-multi-period-set-up.html#cb26-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb26-17"><a href="did-in-multi-period-set-up.html#cb26-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 8 rows containing missing values or values outside the scale range
## (`geom_line()`).</code></pre>
<p><img src="did_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The plot shows that uninsured rate trended parallelly between the treated and control groups prior to the expansion. The rates dropped following the
expansion year (2014) across both the treated and control groups, but the magnitude of drop in uninsured rate is higher for the treated group.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>The DiD uses the control group as the counterfactual for the treated group. In other words, we are assuming that in absence of the treatment, outcome for the treated group would have evolved similarly to that of the control group. This is the key assumption of DiD – the parallel trend assumption. Note that, once we difference out the pre-treatment means between the treated and controls groups, we obtain the dashed line, which is the counterfactual for the treated group. In this case, the counterfactual line overlaps the average outcome for the treated group, suggesting that outcome was trending similarly across the two groups during the pre-treatment period. Loosely speaking, ATT is the average gap between the outcome for the treated group (solid blue line) and the counterfactual outcome (dashed line) during the post-treatment period.</p>
<p>As previously mentioned, we are unable to provide an actual test for parallel trend assumption due to the missing data on treated observations following the treatment in a state when treatment is absent. This does not mean that we are absolutely helpless. There are a list of things that can be done to provide suggestive evidence in favor of or lack of parallel trend. They are:</p>
<ol style="list-style-type: lower-roman">
<li><p>Check pre-treatment summary statistics across treatment and control groups. Say, treatment and control groups have highly different pre-treatment characteristics. It is unlikely that parallel trend assumption will hold in this case. It is because pre-treatment variables that influence the outcome can induce different dynamics in trends. Hence, the outcome trends between the treated and control groups may vary even in absence of the treatment.</p></li>
<li><p>Usually trends in outcomes across treated and control groups are assessed to evaluate parallel trends. If outcome is trending parallely between the two groups prior to the treatment, then it provides evidence in favor of PTA. However, concluding that PTA does not hold in a case of non-parallel trend is a narrow assessment at the best, since this approach merely depicts unconditional trends. PTA may have more leverage once (pre-treatment) covariates are accounted for.</p></li>
<li><p>The next approach that has been used widely is the <strong>event-study</strong>. We will discuss this approach soon.</p></li>
</ol>
<p>In most cases, unconditional parallel trend assumption may not be very convincing. Why?</p>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>The drop in uninsured rate for the control group can be explained by the implementation of other aspects of ACA such as subsidies and employment mandate.<a href="did-in-multi-period-set-up.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="canonical-difference-in-differences-framework.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conditional-parallel-trend.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
